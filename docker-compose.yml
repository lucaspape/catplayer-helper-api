version:                     '3'
services:
  database-catalog:
    build:                   javascript
    command:                 node api/database/host/database-catalog.js
    working_dir:             /app/
    restart:                 always
    volumes:
      - static-content:/app
    deploy:
      replicas:              4

  database-releases:
    build:                   javascript
    command:                 node api/database/host/database-releases.js
    working_dir:             /app/
    restart:                 always
    volumes:
      - static-content:/app
    deploy:
      replicas:              4

  database-artists:
    build:                   javascript
    command:                 node api/database/host/database-artists.js
    working_dir:             /app/
    restart:                 always
    volumes:
      - static-content:/app
    deploy:
      replicas:              2

  database-local:
    build:                   javascript
    command:                 node api/database/local/database-local.js
    working_dir:             /app/
    restart:                 always
    volumes:
      - static-content:/app

  database-update-catalog:
    build:                   javascript
    command:                 node api/database/update/database-update-catalog.js
    working_dir:             /app/
    restart:                 always
    volumes:
      - static-content:/app

  database-update-releases:
    build:                   javascript
    command:                 node api/database/update/database-update-releases.js
    working_dir:             /app/
    restart:                 always
    volumes:
      - static-content:/app

  database-update-artists:
    build:                   javascript
    command:                 node api/database/update/database-update-artists.js
    working_dir:             /app/
    restart:                 always
    volumes:
      - static-content:/app

  web:
    build:                   javascript
    command:                 node api/api.js
    working_dir:             /app/
    restart:                 always
    volumes:
      - static-content:/app
    deploy:
      replicas:              10

  recg:
    build:                   javascript
    command:                 node image/image-recognition.js
    working_dir:             /app/
    restart:                 always
    volumes:
      - static-content:/app

  proxy:
    build:                   proxy
    ports:
      - "6000:80"

  proxy-internal:
    build:                   proxy-internal

volumes:
  static-content:
